SELECT   dbo.app_customer.name, dbo.app_customer.[level], dbo.app_customer.number, dbo.app_order.number AS Expr1, 
                dbo.app_order.batch, dbo.app_order.createTime, dbo.app_order.scheduling, dbo.app_orderstatus.name AS Expr2, 
                COUNT_BIG(dbo.app_workorder.[key]) AS workOrders, MIN(dbo.app_workorder.startTime) AS startTime, 
                MAX(dbo.app_workorder.endTime) AS endTime, CAST(DATEDIFF(second, MIN(dbo.app_workorder.startTime), 
                MAX(dbo.app_workorder.endTime)) AS int) AS times, 
                ROUND(CAST(COUNT(CASE [app_product].[result] WHEN '1' THEN 0 END) AS float) / COUNT(dbo.app_product.[key]), 2) 
                AS rate
FROM      dbo.app_order INNER JOIN
                dbo.app_orderstatus ON dbo.app_order.status_id = dbo.app_orderstatus.[key] LEFT OUTER JOIN
                dbo.app_customer ON dbo.app_order.customer_id = dbo.app_customer.[key] LEFT OUTER JOIN
                dbo.app_workorder ON dbo.app_order.[key] = dbo.app_workorder.order_id LEFT OUTER JOIN
                dbo.app_product ON dbo.app_workorder.[key] = dbo.app_product.workOrder_id
WHERE   (dbo.app_orderstatus.name = '完成')
GROUP BY dbo.app_order.customer_id, dbo.app_order.number, dbo.app_customer.name, dbo.app_customer.[level], 
                dbo.app_customer.number, dbo.app_order.batch, dbo.app_order.createTime, dbo.app_order.scheduling, 
                dbo.app_orderstatus.name